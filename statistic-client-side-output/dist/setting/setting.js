System.register(["jimu-core","jimu-ui/advanced/data-source-selector","jimu-ui"],(function(e,t){var a={},u={},i={};return{setters:[function(e){a.DataSourceManager=e.DataSourceManager,a.DataSourceTypes=e.DataSourceTypes,a.Immutable=e.Immutable,a.JimuFieldType=e.JimuFieldType,a.React=e.React},function(e){u.DataSourceSelector=e.DataSourceSelector,u.FieldSelector=e.FieldSelector},function(e){i.MultiSelect=e.MultiSelect}],execute:function(){e((()=>{var e={8891:e=>{"use strict";e.exports=a},726:e=>{"use strict";e.exports=i},338:e=>{"use strict";e.exports=u}},t={};function o(a){var u=t[a];if(void 0!==u)return u.exports;var i=t[a]={exports:{}};return e[a](i,i.exports,o),i.exports}o.d=(e,t)=>{for(var a in t)o.o(t,a)&&!o.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),o.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.p="";var s={};return o.p=window.jimuConfig.baseUrl,(()=>{"use strict";o.r(s),o.d(s,{default:()=>i});var e,t=o(8891),a=o(338),u=o(726);function i(i){const o=(0,t.Immutable)([t.DataSourceTypes.FeatureLayer]),s=(0,t.Immutable)([t.JimuFieldType.Number]),c=(e,a,u)=>{const o=e.dataSourceId,s=t.DataSourceManager.getInstance().getDataSource(o),c=r(a,u);return{id:`${i.id}-ouput`,type:t.DataSourceTypes.FeatureLayer,label:c.label,geometryType:s.getDataSourceJson().geometryType,originDataSources:[e],schema:c,isDataInDataSourceInstance:!0}},r=(e,a)=>{const u={};return a&&a.forEach((a=>{u[a]={jimuName:a+"_output",type:t.JimuFieldType.Number,name:a,originFields:e?[e]:[]}})),{label:`${i.manifest.name}-data-source`,idField:"objectid",fields:Object.assign({objectid:{jimuName:"objectid",type:t.JimuFieldType.Number,name:"objectid"}},u)}},n=()=>i.config.statFunctions;return t.React.createElement("div",{className:"use-feature-layer-setting p-2"},t.React.createElement(a.DataSourceSelector,{mustUseDataSource:!0,types:o,useDataSources:i.useDataSources,useDataSourcesEnabled:i.useDataSourcesEnabled,onChange:e=>{if((null==e?void 0:e.length)>0){const t=c(e[0]);i.onSettingChange({id:i.id,useDataSources:e,config:{}},[t])}},widgetId:i.id}),i.useDataSources&&i.useDataSources[0]&&t.React.createElement("div",{className:"mt-3 px-2"},t.React.createElement("div",{className:"my-2"},"Please select a field."),t.React.createElement(a.FieldSelector,{useDataSources:i.useDataSources,onChange:(e,t)=>{var a,u;const o=c(i.useDataSources[0].asMutable({deep:!0}),null===(a=e[0])||void 0===a?void 0:a.jimuName,n()),s=Object.assign(Object.assign({},i.useDataSources[0]),{fields:e.map((e=>e.jimuName))});i.onSettingChange({id:i.id,useDataSources:[s],config:Object.assign(Object.assign({},i.config),{numberField:null===(u=e[0])||void 0===u?void 0:u.jimuName})},[o])},selectedFields:i.config.numberField?(0,t.Immutable)([i.config.numberField]):null,types:s,useDropdown:!0,isDataSourceDropDownHidden:!0,isSearchInputHidden:!0}),t.React.createElement("div",{className:"my-2"},"Please select a statistic function."),t.React.createElement(u.MultiSelect,{fluid:!0,items:(0,t.Immutable)(Object.keys(e).map((e=>({value:e,label:e})))),values:n(),onClickItem:(e,a,u)=>{var o,s;const r=c(i.useDataSources[0].asMutable({deep:!0}),null===(s=null===(o=i.useDataSources[0])||void 0===o?void 0:o.fields)||void 0===s?void 0:s[0],(0,t.Immutable)(u));i.onSettingChange({id:i.id,useDataSources:i.useDataSources.asMutable({deep:!0}),config:Object.assign(Object.assign({},i.config),{statFunctions:u})},[r])}})))}!function(e){e.avg="avg",e.sum="sum",e.min="min",e.max="max",e.count="count"}(e||(e={}))})(),s})())}}}));